================================================================================
                     GUIDE COMPILATION ET TESTS
                          SecurePhone - Client
================================================================================

================================================================================
OPTION 1: AVEC MAVEN (Recommandé)
================================================================================

PRÉREQUIS:
- Maven 3.6+ installé
- Java 11+ installé

VÉRIFIER L'INSTALLATION:
------------------------
mvn --version
java --version

Si vous ne l'avez pas, installer:
- Ubuntu/Debian: sudo apt-get install maven default-jdk
- Mac: brew install maven java
- Windows: télécharger Apache Maven et Java

================================================================================
COMPILATION COMPLÈTE (client + tests)
================================================================================

Commande:
---------
cd /opt/lampp/htdocs/SecurePhone/client
mvn clean compile

Résultat attendu:
------------------
[INFO] BUILD SUCCESS
[INFO] Total time: XX.XXX s
[INFO] Finished at: 2026-01-23T...

Fichiers générés:
- target/classes/com/securephone/client/audio/*.class
- target/classes/com/securephone/client/models/*.class
- target/classes/com/securephone/client/video/*.class

================================================================================
LANCER LES TESTS UNITAIRES
================================================================================

Commande:
---------
cd /opt/lampp/htdocs/SecurePhone/client
mvn test

Ou avec plus de détails:
------------------------
mvn test -X

Résultat attendu:
------------------
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running com.securephone.client.audio.AudioBufferTest
[INFO] Tests run: 8, Failures: 0, Errors: 0, Skipped: 0
[INFO] Running com.securephone.client.audio.OpusCodecTest
[INFO] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0
[INFO] Running com.securephone.client.models.AudioDeviceTest
[INFO] Tests run: 8, Failures: 0, Errors: 0, Skipped: 0
[INFO] Running com.securephone.client.models.UserSessionTest
[INFO] Tests run: 10, Failures: 0, Errors: 0, Skipped: 0
[INFO] -------------------------------------------------------
[INFO] Tests run: 35, Failures: 0, Errors: 0, Skipped: 0
[INFO] -------------------------------------------------------
[INFO] BUILD SUCCESS

================================================================================
LANCER UN TEST SPÉCIFIQUE
================================================================================

Commande:
---------
cd /opt/lampp/htdocs/SecurePhone/client
mvn test -Dtest=AudioBufferTest

Exemples:
---------
mvn test -Dtest=OpusCodecTest
mvn test -Dtest=AudioDeviceTest
mvn test -Dtest=UserSessionTest

================================================================================
LANCER LE TEST D'INTÉGRATION AUDIO (avec micros/haut-parleurs)
================================================================================

Compiler d'abord:
-----------------
cd /opt/lampp/htdocs/SecurePhone/client
mvn clean compile

Exécuter le test:
-----------------
mvn exec:java -Dexec.mainClass="com.securephone.client.audio.AudioIntegrationTest"

Ou directement:
---------------
java -cp target/classes com.securephone.client.audio.AudioIntegrationTest

Vous verrez:
```
=====================================
   AUDIO INTEGRATION TEST
=====================================

TEST 1: AudioBuffer push/poll
...

TEST 2: Audio Capture and Playback
...
Press ENTER to begin: [APPUYEZ SUR ENTRÉE]
```

ATTENDEZ LES INSTRUCTIONS À L'ÉCRAN.

================================================================================
OPTION 2: SANS MAVEN (Avec javac)
================================================================================

Si Maven n'est pas disponible, compiler manuellement:

ÉTAPE 1: Compiler le code source
---------------------------------
cd /opt/lampp/htdocs/SecurePhone/client

mkdir -p build/classes

javac -d build/classes \
  -sourcepath src/main/java \
  $(find src/main/java -name "*.java")

Résultat:
- build/classes/com/securephone/client/audio/*.class
- build/classes/com/securephone/client/models/*.class
- build/classes/com/securephone/client/video/*.class

ÉTAPE 2: Compiler les tests (avec JUnit)
-----------------------------------------
# Télécharger JUnit d'abord:
# https://github.com/junit-team/junit4/releases/
# ou: wget https://github.com/junit-team/junit4/releases/download/r4.13.2/junit-4.13.2.jar

javac -d build/classes \
  -cp build/classes:junit-4.13.2.jar \
  -sourcepath src/test/java \
  $(find src/test/java -name "*.java")

ÉTAPE 3: Lancer les tests
--------------------------
java -cp build/classes:junit-4.13.2.jar org.junit.runner.JUnitCore \
  com.securephone.client.audio.AudioBufferTest \
  com.securephone.client.audio.OpusCodecTest \
  com.securephone.client.models.AudioDeviceTest \
  com.securephone.client.models.UserSessionTest

ÉTAPE 4: Lancer le test d'intégration
--------------------------------------
java -cp build/classes com.securephone.client.audio.AudioIntegrationTest

================================================================================
VÉRIFICATION RAPIDE DE LA COMPILATION
================================================================================

Commande simple pour vérifier:
------------------------------
cd /opt/lampp/htdocs/SecurePhone/client
mvn clean compile 2>&1 | grep -E "(ERROR|SUCCESS|FAILURE)"

Ou avec javac:
--------------
javac -d /tmp/test src/main/java/com/securephone/client/audio/AudioBuffer.java && echo "✓ OK"

================================================================================
RAPPORT DE COUVERTURE DES TESTS
================================================================================

Générer un rapport Maven:
-------------------------
cd /opt/lampp/htdocs/SecurePhone/client
mvn test jacoco:report

Consulter: target/site/jacoco/index.html

Avec JaCoCo (si disponible):
----------------------------
mvn clean test jacoco:report

================================================================================
RÉSUMÉ DES COMMANDES ESSENTIELLES
================================================================================

Compiler:
---------
mvn clean compile

Tester (tous):
--------------
mvn test

Tester (un seul):
-----------------
mvn test -Dtest=AudioBufferTest

Test d'intégration:
-------------------
mvn exec:java -Dexec.mainClass="com.securephone.client.audio.AudioIntegrationTest"

Nettoyer:
---------
mvn clean

Construire JAR:
---------------
mvn clean package

Exécuter l'app (une fois compilée):
-----------------------------------
java -cp target/classes com.securephone.client.MainClient

================================================================================
DÉPANNAGE
================================================================================

Erreur: "mvn: command not found"
Cause: Maven non installé ou non dans PATH
Solution:
  1. Installer Maven
  2. Ajouter MAVEN_HOME/bin à PATH
  3. Vérifier: mvn --version

Erreur: "error: invalid source release: 11"
Cause: Java 11+ non disponible
Solution:
  1. Installer Java 11+
  2. Vérifier: java --version
  3. Changer <source> et <target> dans pom.xml si vous avez une autre version

Erreur: "LineUnavailableException" au test audio
Cause: Pas d'appareil audio
Solution:
  1. Vérifier: aplay -l (Linux) ou pactl (PulseAudio)
  2. Connecter un microphone/haut-parleurs
  3. Ignorer le test si pas d'audio disponible

Erreur: "Cannot find symbol"
Cause: Classe manquante ou package mal configuré
Solution:
  1. Vérifier la structure des dossiers
  2. Vérifier les déclarations package
  3. Nettoyer et recompiler: mvn clean compile

================================================================================
PROCHAINES ÉTAPES
================================================================================

1. Compiler: mvn clean compile
2. Tester: mvn test
3. Vérifier les résultats
4. En attente du protocole (Hailey) pour AudioClient/VideoClient
5. Coordonner UI avec Hatsu pour PTTButton/AudioControls

================================================================================
